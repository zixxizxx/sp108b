# xv6 - RISCV 




## 安裝 -- 失敗

```
root@localhost:/home/guest/spMore# sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu
Reading package lists... Done
Building dependency tree
Reading state information... Done
build-essential is already the newest version (12.4ubuntu1).
binutils-riscv64-linux-gnu is already the newest version (2.30-21ubuntu1~18.04.2).
gdb-multiarch is already the newest version (8.1-0ubuntu3.2).
The following additional packages will be installed:
  cpp-7-riscv64-linux-gnu cpp-riscv64-linux-gnu gcc-7-cross-base-ports
  gcc-7-riscv64-linux-gnu gcc-7-riscv64-linux-gnu-base gcc-8-cross-base-ports
  libatomic1-riscv64-cross libc6-dev-riscv64-cross libc6-riscv64-cross
  libgcc-7-dev-riscv64-cross libgcc1-riscv64-cross libgomp1-riscv64-cross
  linux-libc-dev-riscv64-cross
Suggested packages:
  gcc-7-locales cpp-doc gcc-7-doc libgcc1-dbg-riscv64-cross
  libgomp1-dbg-riscv64-cross libitm1-dbg-riscv64-cross
  libatomic1-dbg-riscv64-cross libasan4-dbg-riscv64-cross
  liblsan0-dbg-riscv64-cross libtsan0-dbg-riscv64-cross
  libubsan0-dbg-riscv64-cross libcilkrts5-dbg-riscv64-cross
  libmpx2-dbg-riscv64-cross libquadmath0-dbg-riscv64-cross
  gdb-riscv64-linux-gnu gcc-doc git-daemon-run | git-daemon-sysvinit git-doc
  git-el git-email git-gui gitk gitweb git-cvs git-mediawiki git-svn samba
  vde2
The following packages will be REMOVED:
  gcc-multilib
The following NEW packages will be installed:
  cpp-7-riscv64-linux-gnu cpp-riscv64-linux-gnu gcc-7-cross-base-ports
  gcc-7-riscv64-linux-gnu gcc-7-riscv64-linux-gnu-base gcc-8-cross-base-ports
  gcc-riscv64-linux-gnu libatomic1-riscv64-cross libc6-dev-riscv64-cross
  libc6-riscv64-cross libgcc-7-dev-riscv64-cross libgcc1-riscv64-cross
  libgomp1-riscv64-cross linux-libc-dev-riscv64-cross
The following packages will be upgraded:
  git qemu-system-misc
2 upgraded, 14 newly installed, 1 to remove and 312 not upgraded.
Need to get 29.0 MB/34.6 MB of archives.
After this operation, 40.7 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 cpp-riscv64-linux-gnu amd64 4:7.4.0-1ubuntu1.3 [3,452 B]
Get:2 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 gcc-8-cross-base-ports all 8.4.0-1ubuntu1~18.04cross1 [13.7 kB]
Get:3 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 libc6-riscv64-cross all 2.27-3ubuntu1cross1.2 [1,140 kB]
Get:4 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 libgcc1-riscv64-cross all 1:8.4.0-1ubuntu1~18.04cross1 [38.0 kB]
Get:5 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 libgomp1-riscv64-cross all 8.4.0-1ubuntu1~18.04cross1 [59.2 kB]
Get:6 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 libatomic1-riscv64-cross all 8.4.0-1ubuntu1~18.04cross1 [7,176 B]
Get:7 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 gcc-7-riscv64-linux-gnu amd64 7.5.0-3ubuntu1~18.04cross1 [5,895 kB]
Get:8 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 gcc-riscv64-linux-gnu amd64 4:7.4.0-1ubuntu1.3 [1,400 B]
Get:9 http://mirrors.linode.com/ubuntu bionic-updates/main amd64 git amd64 1:2.17.1-1ubuntu0.6 [3,912 kB]
Get:10 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 qemu-system-misc amd64 1:2.11+dfsg-1ubuntu7.23 [13.5 MB]
Get:11 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 linux-libc-dev-riscv64-cross all 4.15.0-35.38cross1.2 [847 kB]
Get:12 http://mirrors.linode.com/ubuntu bionic-updates/universe amd64 libc6-dev-riscv64-cross all 2.27-3ubuntu1cross1.2 [3,575 kB]
Fetched 29.0 MB in 0s (61.6 MB/s)
(Reading database ... 156206 files and directories currently installed.)
Removing gcc-multilib (4:7.4.0-1ubuntu2.3) ...
Selecting previously unselected package gcc-7-riscv64-linux-gnu-base:amd64.
(Reading database ... 156204 files and directories currently installed.)
Preparing to unpack .../00-gcc-7-riscv64-linux-gnu-base_7.5.0-3ubuntu1~18.04cross1_amd64.deb ...
Unpacking gcc-7-riscv64-linux-gnu-base:amd64 (7.5.0-3ubuntu1~18.04cross1) ...
Selecting previously unselected package cpp-7-riscv64-linux-gnu.
Preparing to unpack .../01-cpp-7-riscv64-linux-gnu_7.5.0-3ubuntu1~18.04cross1_amd64.deb ...
Unpacking cpp-7-riscv64-linux-gnu (7.5.0-3ubuntu1~18.04cross1) ...
Selecting previously unselected package cpp-riscv64-linux-gnu.
Preparing to unpack .../02-cpp-riscv64-linux-gnu_4%3a7.4.0-1ubuntu1.3_amd64.deb ...
Unpacking cpp-riscv64-linux-gnu (4:7.4.0-1ubuntu1.3) ...
Selecting previously unselected package gcc-7-cross-base-ports.
Preparing to unpack .../03-gcc-7-cross-base-ports_7.5.0-3ubuntu1~18.04cross1_all.deb ...
Unpacking gcc-7-cross-base-ports (7.5.0-3ubuntu1~18.04cross1) ...
Selecting previously unselected package gcc-8-cross-base-ports.
Preparing to unpack .../04-gcc-8-cross-base-ports_8.4.0-1ubuntu1~18.04cross1_all.deb ...
Unpacking gcc-8-cross-base-ports (8.4.0-1ubuntu1~18.04cross1) ...
Selecting previously unselected package libc6-riscv64-cross.
Preparing to unpack .../05-libc6-riscv64-cross_2.27-3ubuntu1cross1.2_all.deb ...
Unpacking libc6-riscv64-cross (2.27-3ubuntu1cross1.2) ...
Selecting previously unselected package libgcc1-riscv64-cross.
Preparing to unpack .../06-libgcc1-riscv64-cross_1%3a8.4.0-1ubuntu1~18.04cross1_all.deb ...
Unpacking libgcc1-riscv64-cross (1:8.4.0-1ubuntu1~18.04cross1) ...
Selecting previously unselected package libgomp1-riscv64-cross.
Preparing to unpack .../07-libgomp1-riscv64-cross_8.4.0-1ubuntu1~18.04cross1_all.deb ...
Unpacking libgomp1-riscv64-cross (8.4.0-1ubuntu1~18.04cross1) ...
Selecting previously unselected package libatomic1-riscv64-cross.
Preparing to unpack .../08-libatomic1-riscv64-cross_8.4.0-1ubuntu1~18.04cross1_all.deb ...
Unpacking libatomic1-riscv64-cross (8.4.0-1ubuntu1~18.04cross1) ...
Selecting previously unselected package libgcc-7-dev-riscv64-cross.
Preparing to unpack .../09-libgcc-7-dev-riscv64-cross_7.5.0-3ubuntu1~18.04cross1_all.deb ...
Unpacking libgcc-7-dev-riscv64-cross (7.5.0-3ubuntu1~18.04cross1) ...
Selecting previously unselected package gcc-7-riscv64-linux-gnu.
Preparing to unpack .../10-gcc-7-riscv64-linux-gnu_7.5.0-3ubuntu1~18.04cross1_amd64.deb ...
Unpacking gcc-7-riscv64-linux-gnu (7.5.0-3ubuntu1~18.04cross1) ...
Selecting previously unselected package gcc-riscv64-linux-gnu.
Preparing to unpack .../11-gcc-riscv64-linux-gnu_4%3a7.4.0-1ubuntu1.3_amd64.deb ...
Unpacking gcc-riscv64-linux-gnu (4:7.4.0-1ubuntu1.3) ...
Preparing to unpack .../12-git_1%3a2.17.1-1ubuntu0.6_amd64.deb ...
Unpacking git (1:2.17.1-1ubuntu0.6) over (1:2.17.1-1ubuntu0.5) ...
Preparing to unpack .../13-qemu-system-misc_1%3a2.11+dfsg-1ubuntu7.23_amd64.deb ...
Unpacking qemu-system-misc (1:2.11+dfsg-1ubuntu7.23) over (1:2.11+dfsg-1ubuntu7.21) ...
Selecting previously unselected package linux-libc-dev-riscv64-cross.
Preparing to unpack .../14-linux-libc-dev-riscv64-cross_4.15.0-35.38cross1.2_all.deb ...
Unpacking linux-libc-dev-riscv64-cross (4.15.0-35.38cross1.2) ...
Selecting previously unselected package libc6-dev-riscv64-cross.
Preparing to unpack .../15-libc6-dev-riscv64-cross_2.27-3ubuntu1cross1.2_all.deb ...
Unpacking libc6-dev-riscv64-cross (2.27-3ubuntu1cross1.2) ...
Setting up gcc-7-cross-base-ports (7.5.0-3ubuntu1~18.04cross1) ...
Setting up libc6-riscv64-cross (2.27-3ubuntu1cross1.2) ...
Setting up linux-libc-dev-riscv64-cross (4.15.0-35.38cross1.2) ...
Processing triggers for man-db (2.8.3-2) ...
Setting up gcc-7-riscv64-linux-gnu-base:amd64 (7.5.0-3ubuntu1~18.04cross1) ...
Setting up cpp-7-riscv64-linux-gnu (7.5.0-3ubuntu1~18.04cross1) ...
Setting up gcc-8-cross-base-ports (8.4.0-1ubuntu1~18.04cross1) ...
Setting up qemu-system-misc (1:2.11+dfsg-1ubuntu7.23) ...
Setting up git (1:2.17.1-1ubuntu0.6) ...
Setting up libgomp1-riscv64-cross (8.4.0-1ubuntu1~18.04cross1) ...
Setting up libatomic1-riscv64-cross (8.4.0-1ubuntu1~18.04cross1) ...
Setting up libc6-dev-riscv64-cross (2.27-3ubuntu1cross1.2) ...
Setting up libgcc1-riscv64-cross (1:8.4.0-1ubuntu1~18.04cross1) ...
Setting up cpp-riscv64-linux-gnu (4:7.4.0-1ubuntu1.3) ...
Setting up libgcc-7-dev-riscv64-cross (7.5.0-3ubuntu1~18.04cross1) ...
Setting up gcc-7-riscv64-linux-gnu (7.5.0-3ubuntu1~18.04cross1) ...
Setting up gcc-riscv64-linux-gnu (4:7.4.0-1ubuntu1.3) ...
```

## 檢查

```
root@localhost:/home/guest/spMore# riscv64-unknown-elf-gcc --version

riscv64-unknown-elf-gcc (GCC) 7.2.0
Copyright (C) 2017 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

root@localhost:/home/guest/spMore# qemu-system-riscv64 --version
qemu-system-riscv64: command not found

```


```
root@localhost:~/ccc# qemu-system-riscv64 --version
QEMU emulator version 4.1.0
Copyright (c) 2003-2019 Fabrice Bellard and the QEMU Project developers
root@localhost:~/ccc# git clone https://github.com/mit-pdos/xv6-riscv.git
Cloning into 'xv6-riscv'...
remote: Enumerating objects: 6314, done.
remote: Total 6314 (delta 0), reused 0 (delta 0), pack-reused 6314
Receiving objects: 100% (6314/6314), 15.63 MiB | 9.25 MiB/s, done.
Resolving deltas: 100% (3207/3207), done.
root@localhost:~/ccc# cd xv6-riscv/
root@localhost:~/ccc/xv6-riscv# ls
doc  kernel  LICENSE  Makefile  mkfs  README  user
root@localhost:~/ccc/xv6-riscv# make qemu
riscv64-unknown-elf-gcc    -c -o kernel/entry.o kernel/entry.S
riscv64-unknown-elf-gcc -Wall -Werror -O -fno-omit-frame-pointer -ggdb -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -fno-pie -no-pie   -c -o kernel/start.o kernel/start.c
riscv64-unknown-elf-gcc: error: unrecognized command line option '-mno-relax'; did you mean '-Wno-vla'?
<builtin>: recipe for target 'kernel/start.o' failed
make: *** [kernel/start.o] Error 1

```